[env:esp32dev]
platform = espressif32
board = esp32dev
framework = arduino

; Serial Monitor Configuration
monitor_speed = 115200

; Version Management
extra_scripts = pre:scripts/version_increment.py

; Build Configuration
build_flags =
    -D CORE_DEBUG_LEVEL=3
    -D CONFIG_ARDUHAL_LOG_COLORS=1
    -Wall
    -Wextra
    -Wpedantic

; Partition Scheme for NVS
board_build.partitions = default.csv

; Code Quality
check_tool = clangtidy
check_flags =
    clangtidy: --config-file=.clang-tidy

; Library Dependencies
lib_deps =
    adafruit/Adafruit BME280 Library@^2.2.2
    milesburton/DallasTemperature@^3.11.0
    paulstoffregen/OneWire@^2.3.7
    bodmer/TFT_eSPI@^2.5.43
    bblanchon/ArduinoJson@^7.0.4

; Native Test Environment for Unit Tests
; This environment runs tests on the host machine without ESP32 hardware.
; The UNIT_TEST flag enables mock sensor implementations for testing business
; logic, data processing, and algorithms without physical sensors.
; Only runs tests in test/unit/ directory - these are self-contained tests.
; See docs/UNIT_TEST_GUIDE.md for detailed usage instructions.
[env:native]
platform = native
build_flags =
    -D UNIT_TEST          ; Enable mock sensor mode for unit testing
    -std=c++17            ; C++17 standard for modern C++ features
    -Wall
    -Wextra
    -Wpedantic
    -I test/mocks         ; Include mock Arduino headers for native testing
lib_deps =
    bblanchon/ArduinoJson@^7.0.4  ; JSON library (same version as ESP32)
test_build_src = no       ; Don't build src/ files - tests are self-contained
test_filter = unit/*      ; Only run tests in test/unit/ directory
check_tool = clangtidy
check_flags =
    clangtidy: --config-file=.clang-tidy

; Integration Test Environment for ESP32
; This environment runs tests on actual ESP32 hardware or emulator.
; Use for tests that require WiFi, Serial, or other ESP32-specific features.
; Only runs tests in test/integration/ directory.
[env:esp32test]
platform = espressif32
board = esp32dev
framework = arduino
build_flags =
    -D UNIT_TEST          ; Enable test mode
    -std=c++17
    -Wall
    -Wextra
    -Wpedantic
lib_deps =
    adafruit/Adafruit BME280 Library@^2.2.2
    milesburton/DallasTemperature@^3.11.0
    paulstoffregen/OneWire@^2.3.7
    bodmer/TFT_eSPI@^2.5.43
    bblanchon/ArduinoJson@^7.0.4
test_build_src = yes      ; Build src/ files for integration testing
test_filter = integration/*  ; Only run tests in test/integration/ directory
